(function(){var e;e=function(){return $("button#update_bracket").on("click",function(e){return GameUpdate.sendGameUpdates(e)})},$(function(){return e()})}).call(this),function(){this.Common=function(){function e(){}return e.reloadPage=function(){return window.location.reload()},e.showError=function(e){return alert(e)},e}()}.call(this),function(){var r,a;window.Store=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(e){return!1}}()?{set:a=function(e,t){var r;try{return t=JSON.stringify(t),localStorage.setItem(e,t),t}catch(n){for(r=0;r<=5;++r)localStorage.removeItem(localStorage.key(localStorage.length-1));return a(e,t)}},get:function(e){var t;return(t=localStorage[e])&&JSON.parse(t)},expire:function(e){var t;return t=localStorage[e],localStorage.removeItem(e),t}}:(r=function(e,t,r){var n,a;return r?((n=new Date).setTime(n.getTime()+24*r*60*60*1e3),a="; expires="+n.toGMTString()):a="",document.cookie=e+"="+t+a+"; path=/",t},{set:function(e,t){return r(e,t,1)},get:function(e){var t,r,n,a;for(e+="=",r=0,n=(a=document.cookie.split(";")).length;r<n;r++)if(0===(t=a[r]).indexOf(e))return t.replace(/^\s+/,"").substring(e.length+1,t.length);return null},expire:function(e){var t;return t=Store.get(e),r(e,"",-1),t}})}.call(this),function(){this.StoreWrapper=function(){function e(){}return e.attrExists=function(e,t,r){return null!=Store.get(this.buildLocalStoreLabel(e,t,r))},e.buildLocalStoreLabel=function(e,t,r){return e+"_"+t+"_"+r},e.buildLocalStorePairs=function(t,r){var n,a;return function(){var e;for(n in e=[],r)a=r[n],"label"!==n&&e.push([this.buildLocalStoreLabel(t,r.label,n),a]);return e}.call(this)},e.getAncestors=function(e){var t;return null!=(t=Store.get("a_"+e))||(t=[]),t},e.getDescendant=function(e){return Store.get("d_"+e)},e.getStoreName=function(e,t){return Store.get(this.buildLocalStoreLabel(e,t,"name"))},e.getStoreWinner=function(e,t){return Store.get(this.buildLocalStoreLabel(e,t,"winner"))},e.getStoreWinnersLabel=function(e,t){return Store.get(this.buildLocalStoreLabel(e,t,"winners_label"))},e.localStore=function(e,t){var r,n,a,o,i;for(i=[],r=0,n=(o=this.buildLocalStorePairs(e,t)).length;r<n;r++)a=o[r],i.push(Store.set(a[0],a[1]));return i},e.setAncestorData=function(e,t){var r,n,a,o;for(Store.set("a_"+e,t),o=[],n=0,a=t.length;n<a;n++)r=t[n],o.push(Store.set("d_"+r,e));return o},e.setStoreName=function(e,t,r){return Store.set(this.buildLocalStoreLabel(e,t,"name"),r)},e.setStoreNew=function(e,t){return Store.set(this.buildLocalStoreLabel(e,t,"is_new"),!0)},e.setStoreWinner=function(e,t,r){return Store.set(this.buildLocalStoreLabel(e,t,"winner"),r)},e.setStoreWinnersLabel=function(e,t,r){return Store.set(this.buildLocalStoreLabel(e,t,"winners_label"),r)},e.updateStore=function(e){var t,r;return r=e.node,t=e.bracket_id,null!=e.name?this.setStoreName(t,r,e.name):null!=e.winner?(this.setStoreWinner(t,r,e.winner),this.setStoreWinnersLabel(t,r,e.winners_label),this.setStoreNew(t,r)):void 0},e}()}.call(this),function(){this.GameUpdate=function(){function o(){}return o.buildGameData=function(e){var t,r,n,a;for(a=[],t=n=63;1<=n;t=--n)null!=(r=this.gameData(t,e))&&a.push(r);return a},o.clearNewGameChoiceFlags=function(e){var t,r,n;for(n=[],t=r=63;1<=r;t=--r)StoreWrapper.attrExists(e,t,"is_new")&&n.push(this.expireAttr(e,t,"is_new"));return n},o.expireAttr=function(e,t,r){return Store.expire(StoreWrapper.buildLocalStoreLabel(e,t,r))},o.gameData=function(e,t){return StoreWrapper.attrExists(t,e,"is_new")?[e,StoreWrapper.getStoreWinner(t,e),StoreWrapper.getStoreWinnersLabel(t,e)]:null},o.gameUpdateCallCleanUp=function(){return installGameUpdateClickHandler()},o.gameUpdateError=function(e,t){return showError(e,t),this.gameUpdateCallCleanUp()},o.gameUpdateSetup=function(e){var t;return e.preventDefault(),$("div.success").text("").removeClass("success"),t=e.target,$(t).prop("disabled",!0),[t,$("table.bracket").data("bracket_id")]},o.gameUpdateSuccess=function(e){return this.clearNewGameChoiceFlags(e),Common.reloadPage(),this.gameUpdateCallCleanUp()},o.sendGameUpdates=function(e){var t,r,n,a;return r=this.gameUpdateSetup(e),a=r[0],t=r[1],n=this.buildGameData(t),$.ajax({contentType:"application/json",type:"PUT",url:$(a).closest("form").attr("action"),data:JSON.stringify({bracket:{game_data:n}}),success:function(){return o.gameUpdateSuccess(t)},error:function(e,t,r){return o.gameUpdateError(r,t)},complete:function(){return $(a).prop("disabled",!1)}}),!1},o}()}.call(this);